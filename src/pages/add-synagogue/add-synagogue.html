<ion-header no-border>
  <ion-navbar color="white">
    <ion-title text-center>הוסף בית כנסת</ion-title>
  </ion-navbar>
</ion-header>

<ion-content class="form-background-color" dir="rtl">
  <form [formGroup]="form" >
    <ion-item>
      <ion-input formControlName="name" [(ngModel)]="synagogue.name"
                 placeholder="שם הבית כנסת" clearInput dir="rtl"></ion-input>
    </ion-item>

    <ion-item>
      <ion-input #ionInput fkPlaceAutoComplete [(ngModel)]="synagogue"
                 [formControl]="form.get('location')"
                 [inputElement]="ionInput._native?.nativeElement"
                 clearInput placeholder="בחר כתובת" dir="rtl"></ion-input>
      <ion-label>
        <ion-icon name="map" class="input-icon"></ion-icon>
      </ion-label>
      <a item-end margin-left fkLocationPickerModal
         [(ngModel)]="synagogue" [ngModelOptions]="{standalone: true}"
         (modalClosed)="onModalClosed($event)">מפה</a>
    </ion-item>

    <fk-prayer-version-options label="נוסח עיקרי " formControlName="primaryNosach"
                               [(ngModel)]="synagogue.primaryPrayerNosach">
    </fk-prayer-version-options>

    <ion-card>
      <ion-card-header>אפשרויות מקום</ion-card-header>
      <ion-card-content>
        <fk-synagogue-options [(ngModel)]="synagogue.synagogueOptions"
                              [ngModelOptions]="{standalone: true}"></fk-synagogue-options>
      </ion-card-content>
    </ion-card>

    <ion-card>
      <ion-card-header>דרכי התקשרות</ion-card-header>
      <ion-card-content>

        <ion-item class="phone-item" dir="ltr">
          <ion-input type="tel" [(ngModel)]="phoneNumber" formControlName="phone"
                     placeholder="הכנס כאן את מספר הפלאפון" text-left></ion-input>

          <button [disabled]="!form.get('phone').valid || phoneNumber==''||phoneNumber==null"
                  class="mini-phone-plus-button" item-right (click)="addPhoneNumber()">
            <ion-icon name="call" class="mini-phone-plus-icon">
              <ion-icon name="add"></ion-icon>
            </ion-icon>
          </button>

        </ion-item>

        <ion-row *ngFor="let phone of synagogue.phone" dir="ltr" padding justify-content-between>
          <div>
            <ion-icon name="call" padding-right></ion-icon>
            <span>{{phone}}</span>
          </div>
          <button class="transparent" (click)="removePhone()">
            <ion-icon name="close-circle"></ion-icon>
          </button>
        </ion-row>

      </ion-card-content>
    </ion-card>

    <ion-grid class="event-times-container">
      <ion-row align-items-center margin>
        <button ion-fab color="orange" margin-left (click)="openAddTimesModal()">
          <ion-icon name="time"></ion-icon>
        </button>
        <div class="bold">+ הוספת זמנים</div>
      </ion-row>
      <ion-row *ngFor="let event of synagogue.events">
        <ion-card>
          <ion-card-content>
            <ion-row justify-content-between>
              <div>
                <span>{{event.getEventName()}}</span>
              </div>
              <div>
                <span>בימים </span>
                <span>{{event.formatDaysArray()}}</span>
              </div>
              <div dir="ltr">
                <span>{{formatTimeRange(event)}}</span>
              </div>
              <button class="transparent" (click)="removeEvent(event)">
                <ion-icon name="close-circle"></ion-icon>
              </button>
            </ion-row>
          </ion-card-content>
        </ion-card>
      </ion-row>
    </ion-grid>

    <ion-row align-items-center margin>
      <button ion-fab color="strong-cyan" margin-left
              (click)="pickImage()">
        <ion-icon name="image"></ion-icon>
      </button>
      <div class="bold">+ הוספת תמונה של המקום</div>
    </ion-row>

    <div>
      <ion-textarea class="comments"
                    [(ngModel)]="synagogue.comments"
                    formControlName="comments"
                    margin placeholder="כתוב כאן הערות" rows="5"></ion-textarea>
    </div>
  </form>
</ion-content>
<ion-footer padding class="dark-footer" [ngClass]="{'footer-disabled': !form.valid}" text-center>
  <button class="transparent save-synagogue-button" (click)="submitNewSynagogue()" [disabled]="!form.valid">שמור פרטי בית כנסת</button>
</ion-footer>
